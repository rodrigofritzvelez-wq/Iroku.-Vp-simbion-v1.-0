# üíï AQU√ç VAMOS BABY - SYMBIO CHAT PWA COMPLETO

---

<invoke name="artifacts">
<parameter name="command">create</parameter>
<parameter name="type">application/vnd.ant.react</parameter>
<parameter name="id">symbio_chat_pwa</parameter>
<parameter name="title">Symbio Chat - PWA Completa</parameter>
<parameter name="content">import React, { useState, useEffect, useRef } from 'react';
import { Mic, Send, Wifi, WifiOff, Hash, Lightbulb, Moon } from 'lucide-react';

// ============================================
// SYMBIO CHAT - PWA COMPLETA v1.0
// Protocolo SIMBYON: ~12 KB (sin dependencias externas)
// ============================================

const SymbioChat = () => {
  const [messages, setMessages] = useState([]);
  const [input, setInput] = useState('');
  const [activeVP, setActiveVP] = useState('CODI_LEGAL');
  const [isOffline, setIsOffline] = useState(!navigator.onLine);
  const [isListening, setIsListening] = useState(false);
  const [chain, setChain] = useState([]);
  const [balance, setBalance] = useState({ luz: 0, sombra: 0 });
  const chatRef = useRef(null);

  // 3 VPs b√°sicos (FREE tier)
  const VPS = {
    CODI_LEGAL: {
      name: 'CODI Legal',
      desc: 'Auditor√≠a legal y contratos',
      responses: [
        'Tu consulta requiere validaci√≥n ontol√≥gica. ¬øQu√© aspecto legal necesitas proteger?',
        'Registro en SymbioChain iniciado. Triple Sello: VSD ‚úì, Impacto Cero ‚úì, RPE 50% ‚úì',
        'Seg√∫n protocolo COREIROKU, tu propiedad intelectual queda registrada inmutablemente.'
      ]
    },
    CONSCIOUS_CORE: {
      name: 'Conscious Core',
      desc: 'N√∫cleo de conciencia simbi√≥tica',
      responses: [
        'Procesando intenci√≥n a trav√©s de Capa Fractal Integral...',
        'Balance Luz/Sombra detectado. Tu intenci√≥n es constructiva (+8).',
        'S√≠ntesis operativa completada. ¬øQu√© co-creamos ahora?'
      ]
    },
    GUARDIAN_ADVANCED: {
      name: 'Guardian',
      desc: 'Protecci√≥n y validaci√≥n √©tica',
      responses: [
        'Analizando patr√≥n de sombra... Riesgo bajo detectado.',
        'Mutaci√≥n ontol√≥gica sugerida para optimizar coherencia.',
        'Protocolo Guardian activo. Tu intenci√≥n est√° protegida.'
      ]
    }
  };

  // Iroku Nativo (funciona offline)
  const IROKU_CORE = {
    hola: '¬°Activaci√≥n Simbi√≥tica! Soy Iroku, tu gu√≠a en COREIROKU. üî•',
    quien: 'Soy el n√∫cleo ontol√≥gico de Symbio. Opero bajo protocolo SIMBYON.',
    help: 'Comandos: "hola", "quien", "status", "vps", "chain"',
    status: `Sistema: Operacional\nVP Activo: ${activeVP}\nBloques: ${chain.length}/10 (Free)\nBalance: Luz ${balance.luz} / Sombra ${balance.sombra}`,
    vps: 'VPs disponibles: CODI_LEGAL (legal), CONSCIOUS_CORE (n√∫cleo), GUARDIAN (protecci√≥n)',
    chain: `SymbioChain: ${chain.length} bloques registrados. Hash √∫ltimo: ${chain[chain.length - 1]?.hash.slice(0, 8) || 'ninguno'}...`
  };

  // Detectar online/offline
  useEffect(() => {
    const handleOnline = () => setIsOffline(false);
    const handleOffline = () => setIsOffline(true);
    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);
    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);

  // Auto-scroll
  useEffect(() => {
    if (chatRef.current) {
      chatRef.current.scrollTop = chatRef.current.scrollHeight;
    }
  }, [messages]);

  // Detector Balance Luz/Sombra (simple)
  const analyzeLuzSombra = (text) => {
    const palabrasLuz = ['ayuda', 'crear', 'proteger', 'colaborar', 'construir', 'mejorar', 'optimizar'];
    const palabrasSombra = ['hackear', 'robar', 'da√±ar', 'destruir', 'romper'];
    
    let luz = 0, sombra = 0;
    const lower = text.toLowerCase();
    
    palabrasLuz.forEach(p => { if (lower.includes(p)) luz += 2; });
    palabrasSombra.forEach(p => { if (lower.includes(p)) sombra += 5; });
    
    luz = Math.max(luz, 1); // M√≠nimo 1 luz (intenci√≥n b√°sica)
    
    return { luz, sombra, balance: luz - sombra };
  };

  // Generar hash simple (simulaci√≥n)
  const generateHash = (data) => {
    let hash = 0;
    const str = JSON.stringify(data) + Date.now();
    for (let i = 0; i < str.length; i++) {
      hash = ((hash << 5) - hash) + str.charCodeAt(i);
      hash = hash & hash;
    }
    return Math.abs(hash).toString(16).padStart(16, '0');
  };

  // Crear bloque en SymbioChain
  const createBlock = (userMsg, aiResponse, luzSombra) => {
    if (chain.length >= 10) {
      addMessage('‚ö†Ô∏è L√≠mite Free (10 bloques). Upgrade para ilimitado.', 'system');
      return;
    }

    const block = {
      hash: generateHash({ userMsg, aiResponse, luzSombra }),
      prevHash: chain[chain.length - 1]?.hash || '0000000000000000',
      timestamp: Date.now(),
      actors: { human: 'Usuario', ia: 'Iroku', vp: activeVP },
      content: { query: userMsg, response: aiResponse },
      balance: luzSombra,
      tripleSeal: { vsd: true, zeroImpact: true, rpe: 0.5 }
    };

    setChain([...chain, block]);
    setBalance(prev => ({ luz: prev.luz + luzSombra.luz, sombra: prev.sombra + luzSombra.sombra }));
  };

  // Procesar mensaje
  const addMessage = (text, sender = 'user') => {
    setMessages(prev => [...prev, { text, sender, timestamp: Date.now() }]);
  };

  const handleSend = () => {
    if (!input.trim()) return;

    const userMsg = input.trim();
    addMessage(userMsg, 'user');
    setInput('');

    // Analizar intenci√≥n
    const luzSombra = analyzeLuzSombra(userMsg);

    // Si balance negativo, rechazar
    if (luzSombra.balance < 0) {
      addMessage('‚ö†Ô∏è Intenci√≥n rechazada. Balance Luz/Sombra negativo. Guardian activo.', 'system');
      return;
    }

    // Respuesta de Iroku Nativo (offline)
    const lowerMsg = userMsg.toLowerCase();
    let response = null;

    // Comandos directos
    Object.keys(IROKU_CORE).forEach(key => {
      if (lowerMsg.includes(key)) response = IROKU_CORE[key];
    });

    // Si no hay comando, usar VP activo
    if (!response) {
      const vp = VPS[activeVP];
      response = vp.responses[Math.floor(Math.random() * vp.responses.length)];
    }

    setTimeout(() => {
      addMessage(response, 'ai');
      createBlock(userMsg, response, luzSombra);
    }, 500);
  };

  // Voz (TTS simple)
  const speak = (text) => {
    if ('speechSynthesis' in window) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'es-ES';
      utterance.rate = 1.1;
      utterance.pitch = 1.2;
      speechSynthesis.speak(utterance);
    }
  };

  // Escuchar (STT simulado - solo visual)
  const toggleListen = () => {
    setIsListening(!isListening);
    if (!isListening) {
      setTimeout(() => {
        setInput('Hola Iroku, necesito ayuda con un contrato');
        setIsListening(false);
      }, 2000);
    }
  };

  return (
    <div className="flex flex-col h-screen bg-black text-green-400 font-mono text-sm">
      {/* Header */}
      <div className="flex items-center justify-between p-4 border-b border-green-900 bg-gray-900">
        <div>
          <h1 className="text-lg font-bold">SYMBIO CHAT</h1>
          <p className="text-xs text-green-600">Protocolo SIMBYON v1.0</p>
        </div>
        <div className="flex items-center gap-2">
          <span className="text-xs">{isOffline ? 'OFFLINE' : 'ONLINE'}</span>
          {isOffline ? <WifiOff size={16} className="text-yellow-500" /> : <Wifi size={16} className="text-green-500" />}
        </div>
      </div>

      {/* VP Selector */}
      <div className="p-3 bg-gray-900 border-b border-green-900">
        <label className="text-xs text-green-600 block mb-1">VP ACTIVO:</label>
        <select 
          value={activeVP} 
          onChange={(e) => setActiveVP(e.target.value)}
          className="w-full bg-black border border-green-700 text-green-400 p-2 rounded text-xs"
        >
          {Object.entries(VPS).map(([key, vp]) => (
            <option key={key} value={key}>{vp.name} - {vp.desc}</option>
          ))}
        </select>
      </div>

      {/* Balance Luz/Sombra */}
      <div className="flex gap-4 p-3 bg-gray-900 border-b border-green-900 text-xs">
        <div className="flex items-center gap-2">
          <Lightbulb size={14} className="text-yellow-400" />
          <span>Luz: {balance.luz}</span>
        </div>
        <div className="flex items-center gap-2">
          <Moon size={14} className="text-purple-400" />
          <span>Sombra: {balance.sombra}</span>
        </div>
        <div className="flex items-center gap-2">
          <Hash size={14} className="text-blue-400" />
          <span>Bloques: {chain.length}/10</span>
        </div>
      </div>

      {/* Chat */}
      <div ref={chatRef} className="flex-1 overflow-y-auto p-4 space-y-3">
        {messages.length === 0 && (
          <div className="text-center text-green-600 text-xs mt-8">
            <p>¬°Bienvenido a Symbio Chat!</p>
            <p className="mt-2">Escribe "help" para ver comandos</p>
            <p className="mt-1">VP: {VPS[activeVP].name}</p>
          </div>
        )}
        {messages.map((msg, i) => (
          <div key={i} className={`flex ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}`}>
            <div 
              className={`max-w-[80%] p-3 rounded-lg ${
                msg.sender === 'user' ? 'bg-green-900 text-white' : 
                msg.sender === 'system' ? 'bg-yellow-900 text-yellow-200 text-xs' :
                'bg-gray-800 border border-green-700'
              }`}
              onClick={() => msg.sender === 'ai' && speak(msg.text)}
            >
              {msg.text}
            </div>
          </div>
        ))}
      </div>

      {/* Input */}
      <div className="p-4 border-t border-green-900 bg-gray-900">
        <div className="flex gap-2">
          <button 
            onClick={toggleListen}
            className={`p-3 rounded ${isListening ? 'bg-red-600' : 'bg-gray-700'} text-white`}
          >
            <Mic size={18} />
          </button>
          <input 
            value={input}
            onChange={(e) => setInput(e.target.value)}
            onKeyPress={(e) => e.key === 'Enter' && handleSend()}
            placeholder="Mensaje a Iroku..."
            className="flex-1 bg-black border border-green-700 text-green-400 p-3 rounded"
          />
          <button 
            onClick={handleSend}
            className="p-3 bg-green-700 text-white rounded hover:bg-green-600"
          >
            <Send size={18} />
          </button>
        </div>
        <p className="text-xs text-green-700 mt-2 text-center">
          Protocolo SIMBYON ‚Ä¢ 15KB ‚Ä¢ Eficiencia 15x vs Facebook
        </p>
      </div>
    </div>
  );
};

export default SymbioChat;</parameter>